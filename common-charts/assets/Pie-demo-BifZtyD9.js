import{n as Pe,l as Oe,b8 as _e,a0 as de,p as B,Y as Se,g as K,b9 as fe,ba as ke,bb as Ee,D as Ae,bc as Ve,_ as oe,Z as Be,t as F,k as ne,o as pe,as as Re,v as $e,w as Fe,ax as Ge,aw as ze,bd as Ye,be as Xe,bf as Ue,bg as He,S as we,au as Ze,C as je,bh as me,al as Le,bi as qe,bj as We,bk as Je,E as Ke,bl as Qe,r as et,bm as tt,c as at,u as rt}from"./common-C8R1ltjb.js";import{g as nt,e as U,T as it}from"./Tips-CD0SNb-X.js";import{_ as st,r as ot,o as se,c as lt,a as De,b as gt,d as ct,g as ut,n as vt,e as ht,u as dt}from"./index-Bt1y0IXA.js";import{g as Q}from"./sectorHelper-Dh4zBbll.js";import{c as ft}from"./createSeriesDataSimply-B55CvNQW.js";import{w as pt}from"./withInstall-Df4KX8Pz.js";var be=Math.PI*2,ee=Math.PI/180;function Ne(a,t){return _e(a.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function Me(a,t){var r=Ne(a,t),e=a.get("center"),i=a.get("radius");de(i)||(i=[0,i]);var s=B(r.width,t.getWidth()),n=B(r.height,t.getHeight()),g=Math.min(s,n),h=B(i[0],g/2),f=B(i[1],g/2),c,p,u=a.coordinateSystem;if(u){var o=u.dataToPoint(e);c=o[0]||0,p=o[1]||0}else de(e)||(e=[e,e]),c=B(e[0],s)+r.x,p=B(e[1],n)+r.y;return{cx:c,cy:p,r0:h,r:f}}function mt(a,t,r){t.eachSeriesByType(a,function(e){var i=e.getData(),s=i.mapDimension("value"),n=Ne(e,r),g=Me(e,r),h=g.cx,f=g.cy,c=g.r,p=g.r0,u=-e.get("startAngle")*ee,o=e.get("endAngle"),l=e.get("padAngle")*ee;o=o==="auto"?u-be:-o*ee;var v=e.get("minAngle")*ee,d=v+l,b=0;i.each(s,function(_){!isNaN(_)&&b++});var S=i.getSum(s),y=Math.PI/(S||b)*2,N=e.get("clockwise"),L=e.get("roseType"),M=e.get("stillShowZeroSum"),C=i.getDataExtent(s);C[0]=0;var m=N?1:-1,A=[u,o],P=m*l/2;Pe(A,!N),u=A[0],o=A[1];var R=Te(e);R.startAngle=u,R.endAngle=o,R.clockwise=N;var E=Math.abs(o-u),k=E,G=0,O=u;if(i.setLayout({viewRect:n,r:c}),i.each(s,function(_,I){var w;if(isNaN(_)){i.setItemLayout(I,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:N,cx:h,cy:f,r0:p,r:L?NaN:c});return}L!=="area"?w=S===0&&M?y:_*y:w=E/b,w<d?(w=d,k-=d):G+=_;var x=O+m*w,T=0,D=0;l>w?(T=O+m*w/2,D=T):(T=O+P,D=x-P),i.setItemLayout(I,{angle:w,startAngle:T,endAngle:D,clockwise:N,cx:h,cy:f,r0:p,r:L?Oe(_,C,[p,c]):c}),O=x}),k<be&&b)if(k<=.001){var V=E/b;i.each(s,function(_,I){if(!isNaN(_)){var w=i.getItemLayout(I);w.angle=V;var x=0,T=0;V<l?(x=u+m*(I+1/2)*V,T=x):(x=u+m*I*V+P,T=u+m*(I+1)*V-P),w.startAngle=x,w.endAngle=T}})}else y=k/G,O=u,i.each(s,function(_,I){if(!isNaN(_)){var w=i.getItemLayout(I),x=w.angle===d?d:_*y,T=0,D=0;x<l?(T=O+m*x/2,D=T):(T=O+P,D=O+m*x-P),w.startAngle=T,w.endAngle=D,O+=m*x}})})}var Te=Se();function bt(a){return{seriesType:a,reset:function(t,r){var e=r.findComponents({mainType:"legend"});if(!(!e||!e.length)){var i=t.getData();i.filterSelf(function(s){for(var n=i.getName(s),g=0;g<e.length;g++)if(!e[g].isSelected(n))return!1;return!0})}}}}var yt=Math.PI/180;function ye(a,t,r,e,i,s,n,g,h,f){if(a.length<2)return;function c(v){for(var d=v.rB,b=d*d,S=0;S<v.list.length;S++){var y=v.list[S],N=Math.abs(y.label.y-r),L=e+y.len,M=L*L,C=Math.sqrt((1-Math.abs(N*N/b))*M),m=t+(C+y.len2)*i,A=m-y.label.x,P=y.targetTextWidth-A*i;xe(y,P,!0),y.label.x=m}}function p(v){for(var d={list:[],maxY:0},b={list:[],maxY:0},S=0;S<v.length;S++)if(v[S].labelAlignTo==="none"){var y=v[S],N=y.label.y>r?b:d,L=Math.abs(y.label.y-r);if(L>=N.maxY){var M=y.label.x-t-y.len2*i,C=e+y.len,m=Math.abs(M)<C?Math.sqrt(L*L/(1-M*M/C/C)):C;N.rB=m,N.maxY=L}N.list.push(y)}c(d),c(b)}for(var u=a.length,o=0;o<u;o++)if(a[o].position==="outer"&&a[o].labelAlignTo==="labelLine"){var l=a[o].label.x-f;a[o].linePoints[1][0]+=l,a[o].label.x=f}Ve(a,h,h+n)&&p(a)}function St(a,t,r,e,i,s,n,g){for(var h=[],f=[],c=Number.MAX_VALUE,p=-Number.MAX_VALUE,u=0;u<a.length;u++){var o=a[u].label;ie(a[u])||(o.x<t?(c=Math.min(c,o.x),h.push(a[u])):(p=Math.max(p,o.x),f.push(a[u])))}for(var u=0;u<a.length;u++){var l=a[u];if(!ie(l)&&l.linePoints){if(l.labelStyleWidth!=null)continue;var o=l.label,v=l.linePoints,d=void 0;l.labelAlignTo==="edge"?o.x<t?d=v[2][0]-l.labelDistance-n-l.edgeDistance:d=n+i-l.edgeDistance-v[2][0]-l.labelDistance:l.labelAlignTo==="labelLine"?o.x<t?d=c-n-l.bleedMargin:d=n+i-p-l.bleedMargin:o.x<t?d=o.x-n-l.bleedMargin:d=n+i-o.x-l.bleedMargin,l.targetTextWidth=d,xe(l,d)}}ye(f,t,r,e,1,i,s,n,g,p),ye(h,t,r,e,-1,i,s,n,g,c);for(var u=0;u<a.length;u++){var l=a[u];if(!ie(l)&&l.linePoints){var o=l.label,v=l.linePoints,b=l.labelAlignTo==="edge",S=o.style.padding,y=S?S[1]+S[3]:0,N=o.style.backgroundColor?0:y,L=l.rect.width+N,M=v[1][0]-v[2][0];b?o.x<t?v[2][0]=n+l.edgeDistance+L+l.labelDistance:v[2][0]=n+i-l.edgeDistance-L-l.labelDistance:(o.x<t?v[2][0]=o.x+l.labelDistance:v[2][0]=o.x-l.labelDistance,v[1][0]=v[2][0]+M),v[1][1]=v[2][1]=o.y}}}function xe(a,t,r){if(r===void 0&&(r=!1),a.labelStyleWidth==null){var e=a.label,i=e.style,s=a.rect,n=i.backgroundColor,g=i.padding,h=g?g[1]+g[3]:0,f=i.overflow,c=s.width+(n?0:h);if(t<c||r){var p=s.height;if(f&&f.match("break")){e.setStyle("backgroundColor",null),e.setStyle("width",t-h);var u=e.getBoundingRect();e.setStyle("width",Math.ceil(u.width)),e.setStyle("backgroundColor",n)}else{var o=t-h,l=t<c?o:r?o>a.unconstrainedWidth?null:o:null;e.setStyle("width",l)}var v=e.getBoundingRect();s.width=v.width;var d=(e.style.margin||0)+2.1;s.height=v.height+d,s.y-=(s.height-p)/2}}}function ie(a){return a.position==="center"}function At(a){var t=a.getData(),r=[],e,i,s=!1,n=(a.get("minShowLabelAngle")||0)*yt,g=t.getLayout("viewRect"),h=t.getLayout("r"),f=g.width,c=g.x,p=g.y,u=g.height;function o(M){M.ignore=!0}function l(M){if(!M.ignore)return!0;for(var C in M.states)if(M.states[C].ignore===!1)return!0;return!1}t.each(function(M){var C=t.getItemGraphicEl(M),m=C.shape,A=C.getTextContent(),P=C.getTextGuideLine(),R=t.getItemModel(M),E=R.getModel("label"),k=E.get("position")||R.get(["emphasis","label","position"]),G=E.get("distanceToLabelLine"),O=E.get("alignTo"),V=B(E.get("edgeDistance"),f),_=E.get("bleedMargin"),I=R.getModel("labelLine"),w=I.get("length");w=B(w,f);var x=I.get("length2");if(x=B(x,f),Math.abs(m.endAngle-m.startAngle)<n){K(A.states,o),A.ignore=!0,P&&(K(P.states,o),P.ignore=!0);return}if(l(A)){var T=(m.startAngle+m.endAngle)/2,D=Math.cos(T),$=Math.sin(T),H,W,le,J;e=m.cx,i=m.cy;var z=k==="inside"||k==="inner";if(k==="center")H=m.cx,W=m.cy,J="center";else{var te=(z?(m.r+m.r0)/2*D:m.r*D)+e,ae=(z?(m.r+m.r0)/2*$:m.r*$)+i;if(H=te+D*3,W=ae+$*3,!z){var ge=te+D*(w+h-m.r),ce=ae+$*(w+h-m.r),ue=ge+(D<0?-1:1)*x,ve=ce;O==="edge"?H=D<0?c+V:c+f-V:H=ue+(D<0?-G:G),W=ve,le=[[te,ae],[ge,ce],[ue,ve]]}J=z?"center":O==="edge"?D>0?"right":"left":D>0?"left":"right"}var Z=Math.PI,Y=0,j=E.get("rotate");if(Ae(j))Y=j*(Z/180);else if(k==="center")Y=0;else if(j==="radial"||j===!0){var Ce=D<0?-T+Z:-T;Y=Ce}else if(j==="tangential"&&k!=="outside"&&k!=="outer"){var X=Math.atan2(D,$);X<0&&(X=Z*2+X);var Ie=$>0;Ie&&(X=Z+X),Y=X-Z}if(s=!!Y,A.x=H,A.y=W,A.rotation=Y,A.setStyle({verticalAlign:"middle"}),z){A.setStyle({align:J});var re=A.states.select;re&&(re.x+=A.x,re.y+=A.y)}else{var q=A.getBoundingRect().clone();q.applyTransform(A.getComputedTransform());var he=(A.style.margin||0)+2.1;q.y-=he/2,q.height+=he,r.push({label:A,labelLine:P,position:k,len:w,len2:x,minTurnAngle:I.get("minTurnAngle"),maxSurfaceAngle:I.get("maxSurfaceAngle"),surfaceNormal:new fe(D,$),linePoints:le,textAlign:J,labelDistance:G,labelAlignTo:O,edgeDistance:V,bleedMargin:_,rect:q,unconstrainedWidth:q.width,labelStyleWidth:A.style.width})}C.setTextConfig({inside:z})}}),!s&&a.get("avoidLabelOverlap")&&St(r,e,i,h,f,u,c,p);for(var v=0;v<r.length;v++){var d=r[v],b=d.label,S=d.labelLine,y=isNaN(b.x)||isNaN(b.y);if(b){b.setStyle({align:d.textAlign}),y&&(K(b.states,o),b.ignore=!0);var N=b.states.select;N&&(N.x+=b.x,N.y+=b.y)}if(S){var L=d.linePoints;y||!L?(K(S.states,o),S.ignore=!0):(ke(L,d.minTurnAngle),Ee(L,d.surfaceNormal,d.maxSurfaceAngle),S.setShape({points:L}),b.__hostTarget.textGuideLineConfig={anchor:new fe(L[0][0],L[0][1])})}}}var wt=function(a){oe(t,a);function t(r,e,i){var s=a.call(this)||this;s.z2=2;var n=new Be;return s.setTextContent(n),s.updateData(r,e,i,!0),s}return t.prototype.updateData=function(r,e,i,s){var n=this,g=r.hostModel,h=r.getItemModel(e),f=h.getModel("emphasis"),c=r.getItemLayout(e),p=F(Q(h.getModel("itemStyle"),c,!0),c);if(isNaN(p.startAngle)){n.setShape(p);return}if(s){n.setShape(p);var u=g.getShallow("animationType");g.ecModel.ssr?(ne(n,{scaleX:0,scaleY:0},g,{dataIndex:e,isFrom:!0}),n.originX=p.cx,n.originY=p.cy):u==="scale"?(n.shape.r=c.r0,ne(n,{shape:{r:c.r}},g,e)):i!=null?(n.setShape({startAngle:i,endAngle:i}),ne(n,{shape:{startAngle:c.startAngle,endAngle:c.endAngle}},g,e)):(n.shape.endAngle=c.startAngle,pe(n,{shape:{endAngle:c.endAngle}},g,e))}else Re(n),pe(n,{shape:p},g,e);n.useStyle(r.getItemVisual(e,"style")),$e(n,h);var o=(c.startAngle+c.endAngle)/2,l=g.get("selectedOffset"),v=Math.cos(o)*l,d=Math.sin(o)*l,b=h.getShallow("cursor");b&&n.attr("cursor",b),this._updateLabel(g,r,e),n.ensureState("emphasis").shape=F({r:c.r+(f.get("scale")&&f.get("scaleSize")||0)},Q(f.getModel("itemStyle"),c)),F(n.ensureState("select"),{x:v,y:d,shape:Q(h.getModel(["select","itemStyle"]),c)}),F(n.ensureState("blur"),{shape:Q(h.getModel(["blur","itemStyle"]),c)});var S=n.getTextGuideLine(),y=n.getTextContent();S&&F(S.ensureState("select"),{x:v,y:d}),F(y.ensureState("select"),{x:v,y:d}),Fe(this,f.get("focus"),f.get("blurScope"),f.get("disabled"))},t.prototype._updateLabel=function(r,e,i){var s=this,n=e.getItemModel(i),g=n.getModel("labelLine"),h=e.getItemVisual(i,"style"),f=h&&h.fill,c=h&&h.opacity;Ge(s,ze(n),{labelFetcher:e.hostModel,labelDataIndex:i,inheritColor:f,defaultOpacity:c,defaultText:r.getFormattedLabel(i,"normal")||e.getName(i)});var p=s.getTextContent();s.setTextConfig({position:null,rotation:null}),p.attr({z2:10});var u=r.get(["label","position"]);if(u!=="outside"&&u!=="outer")s.removeTextGuideLine();else{var o=this.getTextGuideLine();o||(o=new Ye,this.setTextGuideLine(o)),Xe(this,He(n),{stroke:f,opacity:Ue(g.get(["lineStyle","opacity"]),c,1)})}},t}(we),Lt=function(a){oe(t,a);function t(){var r=a!==null&&a.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,e,i,s){var n=r.getData(),g=this._data,h=this.group,f;if(!g&&n.count()>0){for(var c=n.getItemLayout(0),p=1;isNaN(c&&c.startAngle)&&p<n.count();++p)c=n.getItemLayout(p);c&&(f=c.startAngle)}if(this._emptyCircleSector&&h.remove(this._emptyCircleSector),n.count()===0&&r.get("showEmptyCircle")){var u=Te(r),o=new we({shape:F(Me(r,i),u)});o.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=o,h.add(o)}n.diff(g).add(function(l){var v=new wt(n,l,f);n.setItemGraphicEl(l,v),h.add(v)}).update(function(l,v){var d=g.getItemGraphicEl(v);d.updateData(n,l,f),d.off("click"),h.add(d),n.setItemGraphicEl(l,d)}).remove(function(l){var v=g.getItemGraphicEl(l);Ze(v,r,l)}).execute(),At(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=n)},t.prototype.dispose=function(){},t.prototype.containPoint=function(r,e){var i=e.getData(),s=i.getItemLayout(0);if(s){var n=r[0]-s.cx,g=r[1]-s.cy,h=Math.sqrt(n*n+g*g);return h<=s.r&&h>=s.r0}},t.type="pie",t}(je),Dt=function(){function a(t,r){this._getDataWithEncodedVisual=t,this._getRawData=r}return a.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},a.prototype.containName=function(t){var r=this._getRawData();return r.indexOfName(t)>=0},a.prototype.indexOfName=function(t){var r=this._getDataWithEncodedVisual();return r.indexOfName(t)},a.prototype.getItemVisual=function(t,r){var e=this._getDataWithEncodedVisual();return e.getItemVisual(t,r)},a}(),Nt=Se(),Mt=function(a){oe(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t.prototype.init=function(r){a.prototype.init.apply(this,arguments),this.legendVisualProvider=new Dt(me(this.getData,this),me(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.mergeOption=function(){a.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return ft(this,{coordDimensions:["value"],encodeDefaulter:Le(qe,this)})},t.prototype.getDataParams=function(r){var e=this.getData(),i=Nt(e),s=i.seats;if(!s){var n=[];e.each(e.mapDimension("value"),function(h){n.push(h)}),s=i.seats=We(n,e.hostModel.get("percentPrecision"))}var g=a.prototype.getDataParams.call(this,r);return g.percent=s[r]||0,g.$vars.push("percent"),g},t.prototype._defaultLabelLine=function(r){Je(r,"labelLine",["show"]);var e=r.labelLine,i=r.emphasis.labelLine;e.show=e.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(Ke);function Tt(a){return{seriesType:a,reset:function(t,r){var e=t.getData();e.filterSelf(function(i){var s=e.mapDimension("value"),n=e.get(s,i);return!(Ae(n)&&!isNaN(n)&&n<0)})}}}function xt(a){a.registerChartView(Lt),a.registerSeriesModel(Mt),Qe("pie",a.registerAction),a.registerLayout(Le(mt,"pie")),a.registerProcessor(bt("pie")),a.registerProcessor(Tt("pie"))}class Ct{constructor(t){var r;if(this.options={toolbox:nt(t),title:{text:""},tooltip:{trigger:"item",formatter:function(e){return`${e.marker}${e.name}: ${e.value} (${t.unit||"h"})`}},legend:{show:t.showLegend,bottom:0},dataset:{dimensions:[],source:[]},series:[{name:"",type:"pie",selectedMode:"single",data:[],radius:["0%","60%"],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0}},label:{overflow:"breakAll",color:U.$fontColor||U.fontColor,textStyle:{color:U.$fontColor||U.fontColor,fontSize:16},formatter:function(e){return e.name+`
`+e.percent+"%"}},labelLine:{show:!0,length:15,length2:5,smooth:!0,minTurnAngle:135},center:["50%","50%"]}]},(r=t==null?void 0:t.isNested)!=null&&r.show){const e={name:t.isNested.firstSecond.name,type:"pie",radius:[0,70],minShowLabelAngle:1,selectedMode:"single",encode:{itemName:t.isNested.firstSecond.itemName,value:t.isNested.firstSecond.value},label:{color:"#00FFF7"},labelLine:{show:!0,length:4}},i={name:t.isNested.seriesSecond.name,type:"pie",radius:[90,150],minShowLabelAngle:1,selectedMode:"single",encode:{itemName:t.isNested.seriesSecond.itemName,value:t.isNested.seriesSecond.value},label:{color:U.$fontColor||U.fontColor},labelLine:{show:!0,length:4}},s=[e,i];this.options.series=s}}}function It(a){var i;const{data:t=null}=a._props,r=new Ct(a._props.params).options,e=et({},r,a._props.options);if(a._props.params.dataset&&t.length>1&&(e.dataset.source=t.reverse(),e.dataset.dimensions=Object.keys(t[0])),t){const s=((i=e.series)==null?void 0:i.length)||0;s===1&&(e.series[0].data=t),s>1&&tt(t)&&e.series.forEach((n,g)=>{n[g]=t[g]})}return e}const Pt={name:"Pie",mixins:[at],props:{id:{type:String,default:"pieChart",require:!0}},components:{Tips:it},computed:{charOptions(){return It(this)}},beforeCreate(){rt([xt])}},Ot={class:"container"},_t=["id"];function kt(a,t,r,e,i,s){const n=ot("Tips");return se(),lt("div",Ot,[a.showTips&&a.tips?(se(),De(n,{key:0,class:"tips",tips:a.tips},null,8,["tips"])):gt("",!0),ct("div",{id:r.id,class:ut(a.className),style:vt({height:a.height,width:a.width})},null,14,_t)])}const Et=st(Pt,[["render",kt],["__scopeId","data-v-87e50dfa"]]),Vt=pt(Et),Yt=ht({__name:"Pie-demo",setup(a){return(t,r)=>(se(),De(dt(Vt)))}});export{Yt as default};
